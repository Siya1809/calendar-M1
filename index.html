<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calendrier d'examens</title>
  <meta name="description" content="Toutes mes dates d'examens au m√™me endroit, disponible partout." />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='80'>üìÖ</text></svg>">
  <style>
    :root{--bg:#0b0c0f;--fg:#f6f7fb;--muted:#a9afc1;--card:#151824;--accent:#6ea8fe}
    @media (prefers-color-scheme: light){:root{--bg:#f7f8fb;--fg:#0b0c0f;--muted:#4a5568;--card:#ffffff;--accent:#2563eb}}
    *{box-sizing:border-box}body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Ubuntu,"Helvetica Neue",Arial,sans-serif;background:var(--bg);color:var(--fg);line-height:1.5}
    header{position:sticky;top:0;backdrop-filter:saturate(180%) blur(10px);background:color-mix(in oklab, var(--bg) 85%, transparent);border-bottom:1px solid color-mix(in oklab, var(--fg) 12%, transparent)}
    .wrap{max-width:900px;margin:auto;padding:16px}
    h1{font-size:clamp(20px,3vw,28px);margin:0;display:flex;gap:10px;align-items:center}
    .card{background:var(--card);border:1px solid color-mix(in oklab, var(--fg) 10%, transparent);border-radius:16px;box-shadow:0 8px 30px rgba(0,0,0,.12);padding:12px}
    .grid{display:grid;gap:16px}
    .iframe-wrap{position:relative;padding-top: 65vh;min-height:420px;border-radius:12px;overflow:hidden}
    iframe{position:absolute;inset:0;width:100%;height:100%;border:0}
    .help{font-size:14px;color:var(--muted)}
    footer{opacity:.8}
    .cta{display:inline-flex;align-items:center;gap:8px;border:1px solid color-mix(in oklab, var(--fg) 18%, transparent);padding:10px 14px;border-radius:12px;text-decoration:none;color:var(--fg)}
    .cta:hover{border-color:var(--accent);box-shadow:0 6px 14px rgba(0,0,0,.12)}
    .notice{font-size:14px; padding:10px 12px; border-radius:10px; background:color-mix(in oklab, var(--accent) 10%, transparent); border:1px dashed color-mix(in oklab, var(--accent) 40%, transparent)}
  </style>
</head>
<body>
  <header>
    <div class="wrap" role="banner">
      <h1>üìÖ Calendrier d'examens</h1>
    </div>
  </header>

  <main class="wrap grid" role="main">
    <div class="card">
      <div class="notice" id="setupNotice">
        <strong>Premi√®re fois ?</strong> Remplace l'URL d'int√©gration ci‚Äëdessous par celle de <em>ton</em> Google Agenda public.
        <details>
          <summary>Comment r√©cup√©rer l'URL d'int√©gration ?</summary>
          <ol>
            <li>Ouvre <a href="https://calendar.google.com" target="_blank" rel="noreferrer noopener">Google Agenda</a>.</li>
            <li>Cr√©e un agenda s√©par√© nomm√© ¬´ Examens ¬ª.</li>
            <li>Param√®tres de cet agenda ‚Üí <em>Acc√®s aux √©v√©nements</em> ‚Üí coche ¬´ Rendre disponible au public ¬ª (afficher uniquement les infos de disponibilit√© si tu veux cacher les d√©tails).</li>
            <li>Section <em>Int√©grer l'agenda</em> ‚Üí copie l'<strong>URL d'int√©gration</strong> (commence par <code>https://calendar.google.com/calendar/embed?...\u0026src=...</code>).</li>
            <li>Colle cette URL dans le champ ci‚Äëdessous et clique ¬´ Mettre √† jour ¬ª.</li>
          </ol>
        </details>
      </div>
      <div class="grid">
        <label class="help">URL d'int√©gration Google Agenda
          <input id="embedInput" placeholder="https://calendar.google.com/calendar/embed?src=..." style="width:100%;margin-top:6px;padding:10px 12px;border-radius:10px;border:1px solid color-mix(in oklab, var(--fg) 18%, transparent);background:transparent;color:var(--fg)" />
        </label>
        <div style="display:flex;gap:10px;flex-wrap:wrap">
          <button class="cta" id="saveBtn">Mettre √† jour</button>
          <a class="cta" id="openCal" href="https://calendar.google.com" target="_blank" rel="noreferrer noopener">Ajouter un examen ‚Üó</a>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="iframe-wrap">
        <!-- Remplace la valeur par d√©faut si tu veux forcer une URL sp√©cifique dans le code -->
        <iframe id="calendarFrame" title="Agenda des examens" src="about:blank" loading="lazy"></iframe>
      </div>
      <p class="help">Astuce : ajoute cette page √† l'√©cran d'accueil de ton t√©l√©phone pour l'avoir comme une appli.</p>
    </div>

    <footer class="help">
      Fait avec ‚ù§Ô∏è. Tout ce site est statique : aucun mot de passe, aucune base de donn√©es. L'agenda s'affiche en lecture seule via Google Agenda.
    </footer>
  </main>

  <script>
    const KEY = 'exam_calendar_embed_url_v1';
    const input = document.getElementById('embedInput');
    const frame = document.getElementById('calendarFrame');
    const notice = document.getElementById('setupNotice');
    const save = document.getElementById('saveBtn');

    function apply(url){
      if(!url) return;
      try{
        const u = new URL(url);
        if(u.hostname.includes('calendar.google.com')){
          frame.src = url;
          input.value = url;
          localStorage.setItem(KEY, url);
          notice.style.display = 'none';
        } else {
          alert('URL non valide : colle une URL d\'int√©gration Google Agenda.');
        }
      }catch(e){
        alert('URL invalide.');
      }
    }

    save.addEventListener('click',()=>apply(input.value.trim()));

    // Valeur par d√©faut si pr√©sente dans le hash ?embed=...
    const params = new URLSearchParams(location.hash.slice(1));
    const fromHash = params.get('embed');

    // Priorit√© : hash > localStorage
    const stored = localStorage.getItem(KEY);
    apply(fromHash || stored);
  </script>
</body>
</html>
